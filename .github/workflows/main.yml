name: GreytHR Automation

on:
  workflow_dispatch:
  schedule:
  - cron: "30 2 * * *" # 8:00 AM IST → Sign In
  - cron: "30 14 * * *" # 8:00 PM IST → Sign Out

env:
  TZ: Asia/Kolkata
  USERNAME: ${{ secrets.USERNAME }}
  PASSWORD: ${{ secrets.PASSWORD }}
  EMAIL_USER: ${{ secrets.EMAIL_USER }}
  EMAIL_PASS: ${{ secrets.EMAIL_PASS }}
  EMAIL_TO: ${{ secrets.EMAIL_TO }}

jobs:
  signin:
    runs-on: ubuntu-latest
    if: github.event.schedule == '30 2 * * *'
    steps:
    - uses: actions/checkout@v3
    - uses: actions/setup-node@v4
      with:
        node-version: 18
    - run: npm install
    - run: npx playwright install --with-deps
    - run: npx playwright test tests/signin.spec.ts

  signout:
    runs-on: ubuntu-latest
    if: github.event.schedule == '30 14 * * *'
    steps:
    - uses: actions/checkout@v3
    - uses: actions/setup-node@v4
      with:
        node-version: 18
    - run: npm install
    - run: npx playwright install --with-deps
    - run: npx playwright test tests/signout.spec.ts
